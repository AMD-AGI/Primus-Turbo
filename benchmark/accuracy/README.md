# Numerical correctness of math primitives on AMD GPUs
This benchmark focuses on the numerical correctness of math primitives on AMD GPUs compared to CPU or NVIDIA GPUs, including GEMM, special function(E.g. exp , log, pow,sigmoid).

## How to run

### GPU vs CPU
Run the following commands to benchmark GEMM and special function (SF) operators.
The results will be compared between GPU and CPU, and a report will be automatically saved as an .xlsx file under the specified directory.
```
python eval_gemm_accuracy.py --report-dir-path  /PATH/TO/DIR

python eval_sf_accuracy.py   --report-dir-path  /PATH/TO/DIR
```

### GPU vs GPU
To compare the operator results generated by different GPU platforms, the process can be divided into 3 steps. Using GEMM as an example:

**Step 1**: Run the benchmark script on Platform A, and dump the results.
The benchmark report will be saved in /PATH/TO/REPORT_DIR, and the dumped operator outputs will be saved in /PATH/TO/DUMP_DIR.
```
python eval_gemm_accuracy.py --report-dir-path  /PATH/TO/REPORT_DIR --dump-dir-path /PATH/TO/DUMP_DIR
```

**Step 2**: File transfer.
Package the output from Platform A and send it to the benchmark directory on Platform B, then extract the contents there.

**Step 3**: Run the benchmark script on Platform B, and generate a summary of the results.
```
python eval_gemm_accuracy.py --report-dir-path  /PATH/TO/REPORT_DIR --load-config-path /PATH/TO/LOAD_CONFIG.json
```

When running the benchmark script, you need to specify the JSON file containing data related to platform A, such as
<pre>
    {
        "device_type": "PLATFORM_A",
        "device_name": "DEVICE_A",
        "load_dir": "/PATH/TO/LOAD_DIR",
        "report_path": /PATH/TO/REPORT_DIR
    }
</pre>
