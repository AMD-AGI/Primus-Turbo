# Numerical correctness of math primitives on AMD GPUs
This benchmark focuses on the numerical correctness of math primitives on AMD GPUs compared to CPU or NVIDIA GPUs, including GEMM, special function(E.g. exp , log, pow,sigmoid).
## How to run
### GPU vs CPU
Run the following command to benchmark GEMM operators. The report which compares gemm results generated by GPU and CPU will be automatically saved as XLSX file under /PATH/TO/DIR
<pre> ``` python eval_gemm_accuracy.py --report-dir-path  /PATH/TO/DIR``` </pre>

### GPU vs GPU
To compare the operator results generated by different GPU platforms, the process can be divided into 3 steps. Using GEMM as an example:

**Step 1**: Run the benchmark script on Platform A, and dump the results.
The benchmark report will be saved in /PATH/TO/REPORT_DIR, and the dumped operator outputs will be saved in /PATH/TO/DUMP_DIR.
<pre> ``` python eval_gemm_accuracy.py --report-dir-path  /PATH/TO/REPORT_DIR --dump-dir-path /PATH/TO/DUMP_DIR``` </pre>

**Step 2**: File transfer.
Package the output from Platform A and send it to the benchmark directory on Platform B, then extract the contents there.

**Step 3**: Run the benchmark script on Platform B, and generate a summary of the results.
<pre> ``` python eval_gemm_accuracy.py --report-dir-path  /PATH/TO/REPORT_DIR --load-config-path /PATH/TO/LOAD_CONFIG.json``` </pre>
When running the benchmark script, you need to specify the JSON file containing data related to platform A, such as
<pre> ``` {"device_type": "PLATFORM_A", "device_name": "DEVICE_A", "load_dir": "/PATH/TO/LOAD_DIR",
    "report_path": /PATH/TO/REPORT_DIR}``` </pre>